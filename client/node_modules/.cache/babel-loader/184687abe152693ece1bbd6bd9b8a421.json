{"ast":null,"code":"'use strict';\n\nconst nodeify = require('../nodeify');\n\nconst webcrypto = require('../webcrypto.js')();\n\nexports.utils = require('./rsa-utils');\n\nexports.generateKey = function (bits, callback) {\n  nodeify(webcrypto.subtle.generateKey({\n    name: 'RSASSA-PKCS1-v1_5',\n    modulusLength: bits,\n    publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n    hash: {\n      name: 'SHA-256'\n    }\n  }, true, ['sign', 'verify']).then(exportKey).then(keys => ({\n    privateKey: keys[0],\n    publicKey: keys[1]\n  })), callback);\n}; // Takes a jwk key\n\n\nexports.unmarshalPrivateKey = function (key, callback) {\n  const privateKey = webcrypto.subtle.importKey('jwk', key, {\n    name: 'RSASSA-PKCS1-v1_5',\n    hash: {\n      name: 'SHA-256'\n    }\n  }, true, ['sign']);\n  nodeify(Promise.all([privateKey, derivePublicFromPrivate(key)]).then(keys => exportKey({\n    privateKey: keys[0],\n    publicKey: keys[1]\n  })).then(keys => ({\n    privateKey: keys[0],\n    publicKey: keys[1]\n  })), callback);\n};\n\nexports.getRandomValues = function (arr) {\n  return Buffer.from(webcrypto.getRandomValues(arr));\n};\n\nexports.hashAndSign = function (key, msg, callback) {\n  nodeify(webcrypto.subtle.importKey('jwk', key, {\n    name: 'RSASSA-PKCS1-v1_5',\n    hash: {\n      name: 'SHA-256'\n    }\n  }, false, ['sign']).then(privateKey => {\n    return webcrypto.subtle.sign({\n      name: 'RSASSA-PKCS1-v1_5'\n    }, privateKey, Uint8Array.from(msg));\n  }).then(sig => Buffer.from(sig)), callback);\n};\n\nexports.hashAndVerify = function (key, sig, msg, callback) {\n  nodeify(webcrypto.subtle.importKey('jwk', key, {\n    name: 'RSASSA-PKCS1-v1_5',\n    hash: {\n      name: 'SHA-256'\n    }\n  }, false, ['verify']).then(publicKey => {\n    return webcrypto.subtle.verify({\n      name: 'RSASSA-PKCS1-v1_5'\n    }, publicKey, sig, msg);\n  }), callback);\n};\n\nfunction exportKey(pair) {\n  return Promise.all([webcrypto.subtle.exportKey('jwk', pair.privateKey), webcrypto.subtle.exportKey('jwk', pair.publicKey)]);\n}\n\nfunction derivePublicFromPrivate(jwKey) {\n  return webcrypto.subtle.importKey('jwk', {\n    kty: jwKey.kty,\n    n: jwKey.n,\n    e: jwKey.e\n  }, {\n    name: 'RSASSA-PKCS1-v1_5',\n    hash: {\n      name: 'SHA-256'\n    }\n  }, true, ['verify']);\n}","map":{"version":3,"names":["nodeify","require","webcrypto","exports","utils","generateKey","bits","callback","subtle","name","modulusLength","publicExponent","Uint8Array","hash","then","exportKey","keys","privateKey","publicKey","unmarshalPrivateKey","key","importKey","Promise","all","derivePublicFromPrivate","getRandomValues","arr","Buffer","from","hashAndSign","msg","sign","sig","hashAndVerify","verify","pair","jwKey","kty","n","e"],"sources":["R:/New_Block/client/node_modules/ipfs-api/node_modules/peer-info/node_modules/libp2p-crypto/src/keys/rsa-browser.js"],"sourcesContent":["'use strict'\n\nconst nodeify = require('../nodeify')\n\nconst webcrypto = require('../webcrypto.js')()\n\nexports.utils = require('./rsa-utils')\n\nexports.generateKey = function (bits, callback) {\n  nodeify(webcrypto.subtle.generateKey(\n    {\n      name: 'RSASSA-PKCS1-v1_5',\n      modulusLength: bits,\n      publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n      hash: {name: 'SHA-256'}\n    },\n    true,\n    ['sign', 'verify']\n  )\n    .then(exportKey)\n    .then((keys) => ({\n      privateKey: keys[0],\n      publicKey: keys[1]\n    })), callback)\n}\n\n// Takes a jwk key\nexports.unmarshalPrivateKey = function (key, callback) {\n  const privateKey = webcrypto.subtle.importKey(\n    'jwk',\n    key,\n    {\n      name: 'RSASSA-PKCS1-v1_5',\n      hash: {name: 'SHA-256'}\n    },\n    true,\n    ['sign']\n  )\n\n  nodeify(Promise.all([\n    privateKey,\n    derivePublicFromPrivate(key)\n  ]).then((keys) => exportKey({\n    privateKey: keys[0],\n    publicKey: keys[1]\n  })).then((keys) => ({\n    privateKey: keys[0],\n    publicKey: keys[1]\n  })), callback)\n}\n\nexports.getRandomValues = function (arr) {\n  return Buffer.from(webcrypto.getRandomValues(arr))\n}\n\nexports.hashAndSign = function (key, msg, callback) {\n  nodeify(webcrypto.subtle.importKey(\n    'jwk',\n    key,\n    {\n      name: 'RSASSA-PKCS1-v1_5',\n      hash: {name: 'SHA-256'}\n    },\n    false,\n    ['sign']\n  ).then((privateKey) => {\n    return webcrypto.subtle.sign(\n      {name: 'RSASSA-PKCS1-v1_5'},\n      privateKey,\n      Uint8Array.from(msg)\n    )\n  }).then((sig) => Buffer.from(sig)), callback)\n}\n\nexports.hashAndVerify = function (key, sig, msg, callback) {\n  nodeify(webcrypto.subtle.importKey(\n    'jwk',\n    key,\n    {\n      name: 'RSASSA-PKCS1-v1_5',\n      hash: {name: 'SHA-256'}\n    },\n    false,\n    ['verify']\n  ).then((publicKey) => {\n    return webcrypto.subtle.verify(\n      {name: 'RSASSA-PKCS1-v1_5'},\n      publicKey,\n      sig,\n      msg\n    )\n  }), callback)\n}\n\nfunction exportKey (pair) {\n  return Promise.all([\n    webcrypto.subtle.exportKey('jwk', pair.privateKey),\n    webcrypto.subtle.exportKey('jwk', pair.publicKey)\n  ])\n}\n\nfunction derivePublicFromPrivate (jwKey) {\n  return webcrypto.subtle.importKey(\n    'jwk',\n    {\n      kty: jwKey.kty,\n      n: jwKey.n,\n      e: jwKey.e\n    },\n    {\n      name: 'RSASSA-PKCS1-v1_5',\n      hash: {name: 'SHA-256'}\n    },\n    true,\n    ['verify']\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}