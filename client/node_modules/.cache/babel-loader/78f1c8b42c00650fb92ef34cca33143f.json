{"ast":null,"code":"'use strict';\n\nconst promisify = require('promisify-es6');\n\nconst dagPB = require('ipld-dag-pb');\n\nconst DAGNode = dagPB.DAGNode;\n\nconst Unixfs = require('ipfs-unixfs');\n\nmodule.exports = send => {\n  return promisify((template, callback) => {\n    if (typeof template === 'function') {\n      callback = template;\n      template = undefined;\n    }\n\n    send({\n      path: 'object/new',\n      args: template\n    }, (err, result) => {\n      if (err) {\n        return callback(err);\n      }\n\n      let data;\n\n      if (template) {\n        if (template !== 'unixfs-dir') {\n          return callback(new Error('unkown template: ' + template));\n        }\n\n        data = new Unixfs('directory').marshal();\n      } else {\n        data = Buffer.alloc(0);\n      }\n\n      DAGNode.create(data, (err, node) => {\n        if (err) {\n          return callback(err);\n        }\n\n        if (node.toJSON().multihash !== result.Hash) {\n          return callback(new Error('multihashes do not match'));\n        }\n\n        callback(null, node);\n      });\n    });\n  });\n};","map":{"version":3,"names":["promisify","require","dagPB","DAGNode","Unixfs","module","exports","send","template","callback","undefined","path","args","err","result","data","Error","marshal","Buffer","alloc","create","node","toJSON","multihash","Hash"],"sources":["R:/New_Block/client/node_modules/ipfs-api/src/object/new.js"],"sourcesContent":["'use strict'\n\nconst promisify = require('promisify-es6')\nconst dagPB = require('ipld-dag-pb')\nconst DAGNode = dagPB.DAGNode\nconst Unixfs = require('ipfs-unixfs')\n\nmodule.exports = (send) => {\n  return promisify((template, callback) => {\n    if (typeof template === 'function') {\n      callback = template\n      template = undefined\n    }\n    send({\n      path: 'object/new',\n      args: template\n    }, (err, result) => {\n      if (err) {\n        return callback(err)\n      }\n\n      let data\n\n      if (template) {\n        if (template !== 'unixfs-dir') {\n          return callback(new Error('unkown template: ' + template))\n        }\n        data = (new Unixfs('directory')).marshal()\n      } else {\n        data = Buffer.alloc(0)\n      }\n\n      DAGNode.create(data, (err, node) => {\n        if (err) {\n          return callback(err)\n        }\n\n        if (node.toJSON().multihash !== result.Hash) {\n          return callback(new Error('multihashes do not match'))\n        }\n\n        callback(null, node)\n      })\n    })\n  })\n}\n"],"mappings":"AAAA;;AAEA,MAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB;;AACA,MAAMC,KAAK,GAAGD,OAAO,CAAC,aAAD,CAArB;;AACA,MAAME,OAAO,GAAGD,KAAK,CAACC,OAAtB;;AACA,MAAMC,MAAM,GAAGH,OAAO,CAAC,aAAD,CAAtB;;AAEAI,MAAM,CAACC,OAAP,GAAkBC,IAAD,IAAU;EACzB,OAAOP,SAAS,CAAC,CAACQ,QAAD,EAAWC,QAAX,KAAwB;IACvC,IAAI,OAAOD,QAAP,KAAoB,UAAxB,EAAoC;MAClCC,QAAQ,GAAGD,QAAX;MACAA,QAAQ,GAAGE,SAAX;IACD;;IACDH,IAAI,CAAC;MACHI,IAAI,EAAE,YADH;MAEHC,IAAI,EAAEJ;IAFH,CAAD,EAGD,CAACK,GAAD,EAAMC,MAAN,KAAiB;MAClB,IAAID,GAAJ,EAAS;QACP,OAAOJ,QAAQ,CAACI,GAAD,CAAf;MACD;;MAED,IAAIE,IAAJ;;MAEA,IAAIP,QAAJ,EAAc;QACZ,IAAIA,QAAQ,KAAK,YAAjB,EAA+B;UAC7B,OAAOC,QAAQ,CAAC,IAAIO,KAAJ,CAAU,sBAAsBR,QAAhC,CAAD,CAAf;QACD;;QACDO,IAAI,GAAI,IAAIX,MAAJ,CAAW,WAAX,CAAD,CAA0Ba,OAA1B,EAAP;MACD,CALD,MAKO;QACLF,IAAI,GAAGG,MAAM,CAACC,KAAP,CAAa,CAAb,CAAP;MACD;;MAEDhB,OAAO,CAACiB,MAAR,CAAeL,IAAf,EAAqB,CAACF,GAAD,EAAMQ,IAAN,KAAe;QAClC,IAAIR,GAAJ,EAAS;UACP,OAAOJ,QAAQ,CAACI,GAAD,CAAf;QACD;;QAED,IAAIQ,IAAI,CAACC,MAAL,GAAcC,SAAd,KAA4BT,MAAM,CAACU,IAAvC,EAA6C;UAC3C,OAAOf,QAAQ,CAAC,IAAIO,KAAJ,CAAU,0BAAV,CAAD,CAAf;QACD;;QAEDP,QAAQ,CAAC,IAAD,EAAOY,IAAP,CAAR;MACD,CAVD;IAWD,CA9BG,CAAJ;EA+BD,CApCe,CAAhB;AAqCD,CAtCD"},"metadata":{},"sourceType":"script"}