{"ast":null,"code":"var _jsxFileName = \"R:\\\\CryptoCare\\\\client\\\\src\\\\pages\\\\emergencyPerson\\\\SeeRequests.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from 'react';\nimport { Box, Typography, Backdrop, CircularProgress, RadioGroup, FormControl, FormControlLabel, Radio } from '@mui/material';\nimport SearchRoundedIcon from '@mui/icons-material/SearchRounded';\nimport CustomButton from '../../components/CustomButton';\nimport useEth from '../../contexts/EthContext/useEth';\nimport RequestEmergency from '../../components/RequestEmergency';\nimport useAlert from '../../contexts/AlertContext/useAlert';\nimport EmergencyAccess from '../../components/access/emergencyAccess';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst SeeRequests = () => {\n  _s();\n\n  const {\n    state: {\n      contract,\n      accounts,\n      role,\n      loading\n    }\n  } = useEth();\n  const [requests, setRequests] = useState([]);\n  const [viewRequest, setViewRequest] = useState(false);\n  const {\n    setAlert\n  } = useAlert();\n\n  const getRequests = async () => {\n    try {\n      const patientId = await contract.methods.getPatientIdEmergency().call({\n        from: accounts[0]\n      });\n      const requests = await contract.methods.getRequestsByEmergency(patientId).call({\n        from: accounts[0]\n      }); // console.log(requests)\n\n      setRequests(requests);\n      setViewRequest(true);\n      return;\n    } catch (err) {\n      setAlert(\"You didn't have emergency access\", 'error');\n      console.error(err);\n    }\n  };\n\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Backdrop, {\n      sx: {\n        color: '#fff',\n        zIndex: theme => theme.zIndex.drawer + 1\n      },\n      open: loading,\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n        color: \"inherit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      width: \"100vw\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        width: \"60%\",\n        my: 5,\n        children: [/*#__PURE__*/_jsxDEV(Backdrop, {\n          sx: {\n            color: '#fff',\n            zIndex: theme => theme.zIndex.drawer + 1\n          },\n          open: loading,\n          children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n            color: \"inherit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 48,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 11\n        }, this), !accounts ? /*#__PURE__*/_jsxDEV(Box, {\n          display: \"flex\",\n          justifyContent: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            children: \"Open your MetaMask wallet to get connected, then refresh this page\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 52,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [role === 'emergencyPerson' && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Box, {\n              mx: 2,\n              children: /*#__PURE__*/_jsxDEV(CustomButton, {\n                text: 'See Requests',\n                handleClick: () => getRequests(),\n                children: /*#__PURE__*/_jsxDEV(SearchRoundedIcon, {\n                  style: {\n                    color: 'white'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 60,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 59,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 58,\n              columnNumber: 19\n            }, this), requests.length > 0 && viewRequest && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Box, {\n                display: \"flex\",\n                flexDirection: \"column\",\n                mt: 3,\n                mb: -2,\n                children: requests.map((request, index) => /*#__PURE__*/_jsxDEV(Box, {\n                  mb: 2,\n                  children: /*#__PURE__*/_jsxDEV(RequestEmergency, {\n                    requestEmergency: request\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 68,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 67,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 65,\n                columnNumber: 26\n              }, this), /*#__PURE__*/_jsxDEV(Box, {\n                mx: 2,\n                children: /*#__PURE__*/_jsxDEV(CustomButton, {\n                  text: 'Close Requests',\n                  handleClick: () => setViewRequest(false),\n                  children: /*#__PURE__*/_jsxDEV(SearchRoundedIcon, {\n                    style: {\n                      color: 'white'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 74,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 73,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 72,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true), requests.length == 0 && viewRequest && /*#__PURE__*/_jsxDEV(Box, {\n              display: \"flex\",\n              justifyContent: \"center\",\n              children: /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"h5\",\n                children: \"No requests found\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true), /*#__PURE__*/_jsxDEV(EmergencyAccess, {\n            role: role\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this);\n  }\n};\n\n_s(SeeRequests, \"2KYdd3L7W8biSGYUjjrFb5VSgy8=\", false, function () {\n  return [useEth, useAlert];\n});\n\n_c = SeeRequests;\nexport default SeeRequests;\n\nvar _c;\n\n$RefreshReg$(_c, \"SeeRequests\");","map":{"version":3,"names":["React","useState","useEffect","useContext","Box","Typography","Backdrop","CircularProgress","RadioGroup","FormControl","FormControlLabel","Radio","SearchRoundedIcon","CustomButton","useEth","RequestEmergency","useAlert","EmergencyAccess","SeeRequests","state","contract","accounts","role","loading","requests","setRequests","viewRequest","setViewRequest","setAlert","getRequests","patientId","methods","getPatientIdEmergency","call","from","getRequestsByEmergency","err","console","error","color","zIndex","theme","drawer","length","map","request","index"],"sources":["R:/CryptoCare/client/src/pages/emergencyPerson/SeeRequests.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport { Box, Typography, Backdrop, CircularProgress,RadioGroup, FormControl,FormControlLabel,Radio} from '@mui/material'\r\nimport SearchRoundedIcon from '@mui/icons-material/SearchRounded'\r\nimport CustomButton from '../../components/CustomButton'\r\nimport useEth from '../../contexts/EthContext/useEth'\r\nimport RequestEmergency from '../../components/RequestEmergency'\r\nimport useAlert from '../../contexts/AlertContext/useAlert'\r\nimport EmergencyAccess from '../../components/access/emergencyAccess'\r\n\r\nconst SeeRequests = () => {\r\n  const {\r\n    state: { contract, accounts, role, loading },\r\n  } = useEth()\r\n\r\n  const [requests,setRequests] = useState([])\r\n  const [viewRequest,setViewRequest] = useState(false)\r\n\r\n  const {setAlert} = useAlert()\r\n\r\n\r\n\r\n    const getRequests = async () => {\r\n      try{\r\n        const patientId = await contract.methods.getPatientIdEmergency().call({ from: accounts[0] })\r\n        const requests = await contract.methods.getRequestsByEmergency(patientId).call({ from: accounts[0] })\r\n        // console.log(requests)\r\n        setRequests(requests)\r\n        setViewRequest(true)\r\n        return\r\n      }catch(err){\r\n        setAlert(\"You didn't have emergency access\",'error')\r\n        console.error(err)\r\n      }\r\n    }\r\n\r\n  if (loading) {\r\n    return (\r\n      <Backdrop sx={{ color: '#fff', zIndex: theme => theme.zIndex.drawer + 1 }} open={loading}>\r\n        <CircularProgress color='inherit' />\r\n      </Backdrop>\r\n    )\r\n  }\r\n  else {\r\n    return (\r\n      <Box display='flex' justifyContent='center' width='100vw'>\r\n        <Box width='60%' my={5}>\r\n          <Backdrop sx={{ color: '#fff', zIndex: theme => theme.zIndex.drawer + 1 }} open={loading}>\r\n            <CircularProgress color='inherit' />\r\n          </Backdrop>\r\n          {!accounts ? (\r\n            <Box display='flex' justifyContent='center'>\r\n              <Typography variant='h6'>Open your MetaMask wallet to get connected, then refresh this page</Typography>\r\n            </Box>\r\n          ) : (\r\n            <>\r\n              {role === 'emergencyPerson' && (\r\n                <>\r\n                  <Box mx={2}>\r\n                      <CustomButton text={'See Requests'} handleClick={() => getRequests()}>\r\n                        <SearchRoundedIcon style={{ color: 'white' }} />\r\n                      </CustomButton>\r\n                    </Box>\r\n                    {requests.length > 0 && viewRequest && (\r\n                      <>\r\n                         <Box display='flex' flexDirection='column' mt={3} mb={-2}>\r\n                      {requests.map((request, index) => (\r\n                        <Box mb={2}>\r\n                          <RequestEmergency key={index} requestEmergency={request} />\r\n                        </Box>\r\n                      ))}\r\n                    </Box>\r\n                    <Box mx={2}>\r\n                      <CustomButton text={'Close Requests'} handleClick={() => setViewRequest(false)}>\r\n                        <SearchRoundedIcon style={{ color: 'white' }} />\r\n                      </CustomButton>\r\n                    </Box>\r\n                    </>\r\n\r\n                      )}\r\n                       {requests.length == 0 && viewRequest && (\r\n                        <Box display='flex' justifyContent='center'>\r\n                  <Typography variant='h5'>No requests found</Typography>\r\n                    </Box>\r\n                      )}\r\n                    \r\n\r\n                </>\r\n              )}\r\n              <EmergencyAccess role={role}/>\r\n            </>\r\n          )}\r\n        </Box>\r\n      </Box>\r\n    )\r\n  }\r\n}\r\n\r\nexport default SeeRequests\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}