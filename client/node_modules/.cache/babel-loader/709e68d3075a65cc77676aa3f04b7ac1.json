{"ast":null,"code":"'use strict';\n\nconst protons = require('protons');\n\nconst pb = protons(require('./unixfs.proto')); // encode/decode\n\nconst unixfsData = pb.Data; // const unixfsMetadata = pb.MetaData // encode/decode\n\nconst types = ['raw', 'directory', 'file', 'metadata', 'symlink', 'hamt-sharded-directory'];\nconst dirTypes = ['directory', 'hamt-sharded-directory'];\n\nfunction Data(type, data) {\n  if (!(this instanceof Data)) {\n    return new Data(type, data);\n  }\n\n  if (types.indexOf(type) === -1) {\n    throw new Error('Type: ' + type + ' is not valid');\n  }\n\n  this.type = type;\n  this.data = data;\n  this.blockSizes = [];\n\n  this.addBlockSize = size => {\n    this.blockSizes.push(size);\n  };\n\n  this.removeBlockSize = index => {\n    this.blockSizes.splice(index, 1);\n  }; // data.length + blockSizes\n\n\n  this.fileSize = () => {\n    if (dirTypes.indexOf(this.type) >= 0) {\n      // dirs don't have file size\n      return undefined;\n    }\n\n    let sum = 0;\n    this.blockSizes.forEach(size => {\n      sum += size;\n    });\n\n    if (data) {\n      sum += data.length;\n    }\n\n    return sum;\n  }; // encode to protobuf\n\n\n  this.marshal = () => {\n    let type;\n\n    switch (this.type) {\n      case 'raw':\n        type = unixfsData.DataType.Raw;\n        break;\n\n      case 'directory':\n        type = unixfsData.DataType.Directory;\n        break;\n\n      case 'file':\n        type = unixfsData.DataType.File;\n        break;\n\n      case 'metadata':\n        type = unixfsData.DataType.Metadata;\n        break;\n\n      case 'symlink':\n        type = unixfsData.DataType.Symlink;\n        break;\n\n      case 'hamt-sharded-directory':\n        type = unixfsData.DataType.HAMTShard;\n        break;\n\n      default:\n        throw new Error(`Unkown type: \"${this.type}\"`);\n    }\n\n    let fileSize = this.fileSize();\n    let data = this.data;\n\n    if (!this.data || !this.data.length) {\n      data = undefined;\n    }\n\n    let blockSizes = this.blockSizes;\n\n    if (!this.blockSizes || !this.blockSizes.length) {\n      blockSizes = undefined;\n    }\n\n    return unixfsData.encode({\n      Type: type,\n      Data: data,\n      filesize: fileSize,\n      blocksizes: blockSizes,\n      hashType: this.hashType,\n      fanout: this.fanout\n    });\n  };\n} // decode from protobuf https://github.com/ipfs/go-ipfs/blob/master/unixfs/format.go#L24\n\n\nData.unmarshal = marsheled => {\n  const decoded = unixfsData.decode(marsheled);\n\n  if (!decoded.Data) {\n    decoded.Data = undefined;\n  }\n\n  const obj = new Data(types[decoded.Type], decoded.Data);\n  obj.blockSizes = decoded.blocksizes;\n  return obj;\n};\n\nexports = module.exports = Data;","map":{"version":3,"names":["protons","require","pb","unixfsData","Data","types","dirTypes","type","data","indexOf","Error","blockSizes","addBlockSize","size","push","removeBlockSize","index","splice","fileSize","undefined","sum","forEach","length","marshal","DataType","Raw","Directory","File","Metadata","Symlink","HAMTShard","encode","Type","filesize","blocksizes","hashType","fanout","unmarshal","marsheled","decoded","decode","obj","exports","module"],"sources":["R:/CryptoCare/client/node_modules/ipfs-unixfs/src/index.js"],"sourcesContent":["'use strict'\n\nconst protons = require('protons')\nconst pb = protons(require('./unixfs.proto'))\n// encode/decode\nconst unixfsData = pb.Data\n// const unixfsMetadata = pb.MetaData // encode/decode\n\nconst types = [\n  'raw',\n  'directory',\n  'file',\n  'metadata',\n  'symlink',\n  'hamt-sharded-directory'\n]\n\nconst dirTypes = [\n  'directory',\n  'hamt-sharded-directory'\n]\n\nfunction Data (type, data) {\n  if (!(this instanceof Data)) {\n    return new Data(type, data)\n  }\n  if (types.indexOf(type) === -1) {\n    throw new Error('Type: ' + type + ' is not valid')\n  }\n\n  this.type = type\n  this.data = data\n  this.blockSizes = []\n\n  this.addBlockSize = (size) => {\n    this.blockSizes.push(size)\n  }\n\n  this.removeBlockSize = (index) => {\n    this.blockSizes.splice(index, 1)\n  }\n\n  // data.length + blockSizes\n  this.fileSize = () => {\n    if (dirTypes.indexOf(this.type) >= 0) {\n      // dirs don't have file size\n      return undefined\n    }\n\n    let sum = 0\n    this.blockSizes.forEach((size) => {\n      sum += size\n    })\n    if (data) {\n      sum += data.length\n    }\n    return sum\n  }\n\n  // encode to protobuf\n  this.marshal = () => {\n    let type\n\n    switch (this.type) {\n      case 'raw': type = unixfsData.DataType.Raw; break\n      case 'directory': type = unixfsData.DataType.Directory; break\n      case 'file': type = unixfsData.DataType.File; break\n      case 'metadata': type = unixfsData.DataType.Metadata; break\n      case 'symlink': type = unixfsData.DataType.Symlink; break\n      case 'hamt-sharded-directory': type = unixfsData.DataType.HAMTShard; break\n      default:\n        throw new Error(`Unkown type: \"${this.type}\"`)\n    }\n    let fileSize = this.fileSize()\n\n    let data = this.data\n\n    if (!this.data || !this.data.length) {\n      data = undefined\n    }\n\n    let blockSizes = this.blockSizes\n\n    if (!this.blockSizes || !this.blockSizes.length) {\n      blockSizes = undefined\n    }\n\n    return unixfsData.encode({\n      Type: type,\n      Data: data,\n      filesize: fileSize,\n      blocksizes: blockSizes,\n      hashType: this.hashType,\n      fanout: this.fanout\n    })\n  }\n}\n\n// decode from protobuf https://github.com/ipfs/go-ipfs/blob/master/unixfs/format.go#L24\nData.unmarshal = (marsheled) => {\n  const decoded = unixfsData.decode(marsheled)\n  if (!decoded.Data) {\n    decoded.Data = undefined\n  }\n  const obj = new Data(types[decoded.Type], decoded.Data)\n  obj.blockSizes = decoded.blocksizes\n  return obj\n}\n\nexports = module.exports = Data\n"],"mappings":"AAAA;;AAEA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,MAAMC,EAAE,GAAGF,OAAO,CAACC,OAAO,CAAC,gBAAD,CAAR,CAAlB,C,CACA;;AACA,MAAME,UAAU,GAAGD,EAAE,CAACE,IAAtB,C,CACA;;AAEA,MAAMC,KAAK,GAAG,CACZ,KADY,EAEZ,WAFY,EAGZ,MAHY,EAIZ,UAJY,EAKZ,SALY,EAMZ,wBANY,CAAd;AASA,MAAMC,QAAQ,GAAG,CACf,WADe,EAEf,wBAFe,CAAjB;;AAKA,SAASF,IAAT,CAAeG,IAAf,EAAqBC,IAArB,EAA2B;EACzB,IAAI,EAAE,gBAAgBJ,IAAlB,CAAJ,EAA6B;IAC3B,OAAO,IAAIA,IAAJ,CAASG,IAAT,EAAeC,IAAf,CAAP;EACD;;EACD,IAAIH,KAAK,CAACI,OAAN,CAAcF,IAAd,MAAwB,CAAC,CAA7B,EAAgC;IAC9B,MAAM,IAAIG,KAAJ,CAAU,WAAWH,IAAX,GAAkB,eAA5B,CAAN;EACD;;EAED,KAAKA,IAAL,GAAYA,IAAZ;EACA,KAAKC,IAAL,GAAYA,IAAZ;EACA,KAAKG,UAAL,GAAkB,EAAlB;;EAEA,KAAKC,YAAL,GAAqBC,IAAD,IAAU;IAC5B,KAAKF,UAAL,CAAgBG,IAAhB,CAAqBD,IAArB;EACD,CAFD;;EAIA,KAAKE,eAAL,GAAwBC,KAAD,IAAW;IAChC,KAAKL,UAAL,CAAgBM,MAAhB,CAAuBD,KAAvB,EAA8B,CAA9B;EACD,CAFD,CAhByB,CAoBzB;;;EACA,KAAKE,QAAL,GAAgB,MAAM;IACpB,IAAIZ,QAAQ,CAACG,OAAT,CAAiB,KAAKF,IAAtB,KAA+B,CAAnC,EAAsC;MACpC;MACA,OAAOY,SAAP;IACD;;IAED,IAAIC,GAAG,GAAG,CAAV;IACA,KAAKT,UAAL,CAAgBU,OAAhB,CAAyBR,IAAD,IAAU;MAChCO,GAAG,IAAIP,IAAP;IACD,CAFD;;IAGA,IAAIL,IAAJ,EAAU;MACRY,GAAG,IAAIZ,IAAI,CAACc,MAAZ;IACD;;IACD,OAAOF,GAAP;EACD,CAdD,CArByB,CAqCzB;;;EACA,KAAKG,OAAL,GAAe,MAAM;IACnB,IAAIhB,IAAJ;;IAEA,QAAQ,KAAKA,IAAb;MACE,KAAK,KAAL;QAAYA,IAAI,GAAGJ,UAAU,CAACqB,QAAX,CAAoBC,GAA3B;QAAgC;;MAC5C,KAAK,WAAL;QAAkBlB,IAAI,GAAGJ,UAAU,CAACqB,QAAX,CAAoBE,SAA3B;QAAsC;;MACxD,KAAK,MAAL;QAAanB,IAAI,GAAGJ,UAAU,CAACqB,QAAX,CAAoBG,IAA3B;QAAiC;;MAC9C,KAAK,UAAL;QAAiBpB,IAAI,GAAGJ,UAAU,CAACqB,QAAX,CAAoBI,QAA3B;QAAqC;;MACtD,KAAK,SAAL;QAAgBrB,IAAI,GAAGJ,UAAU,CAACqB,QAAX,CAAoBK,OAA3B;QAAoC;;MACpD,KAAK,wBAAL;QAA+BtB,IAAI,GAAGJ,UAAU,CAACqB,QAAX,CAAoBM,SAA3B;QAAsC;;MACrE;QACE,MAAM,IAAIpB,KAAJ,CAAW,iBAAgB,KAAKH,IAAK,GAArC,CAAN;IARJ;;IAUA,IAAIW,QAAQ,GAAG,KAAKA,QAAL,EAAf;IAEA,IAAIV,IAAI,GAAG,KAAKA,IAAhB;;IAEA,IAAI,CAAC,KAAKA,IAAN,IAAc,CAAC,KAAKA,IAAL,CAAUc,MAA7B,EAAqC;MACnCd,IAAI,GAAGW,SAAP;IACD;;IAED,IAAIR,UAAU,GAAG,KAAKA,UAAtB;;IAEA,IAAI,CAAC,KAAKA,UAAN,IAAoB,CAAC,KAAKA,UAAL,CAAgBW,MAAzC,EAAiD;MAC/CX,UAAU,GAAGQ,SAAb;IACD;;IAED,OAAOhB,UAAU,CAAC4B,MAAX,CAAkB;MACvBC,IAAI,EAAEzB,IADiB;MAEvBH,IAAI,EAAEI,IAFiB;MAGvByB,QAAQ,EAAEf,QAHa;MAIvBgB,UAAU,EAAEvB,UAJW;MAKvBwB,QAAQ,EAAE,KAAKA,QALQ;MAMvBC,MAAM,EAAE,KAAKA;IANU,CAAlB,CAAP;EAQD,CAnCD;AAoCD,C,CAED;;;AACAhC,IAAI,CAACiC,SAAL,GAAkBC,SAAD,IAAe;EAC9B,MAAMC,OAAO,GAAGpC,UAAU,CAACqC,MAAX,CAAkBF,SAAlB,CAAhB;;EACA,IAAI,CAACC,OAAO,CAACnC,IAAb,EAAmB;IACjBmC,OAAO,CAACnC,IAAR,GAAee,SAAf;EACD;;EACD,MAAMsB,GAAG,GAAG,IAAIrC,IAAJ,CAASC,KAAK,CAACkC,OAAO,CAACP,IAAT,CAAd,EAA8BO,OAAO,CAACnC,IAAtC,CAAZ;EACAqC,GAAG,CAAC9B,UAAJ,GAAiB4B,OAAO,CAACL,UAAzB;EACA,OAAOO,GAAP;AACD,CARD;;AAUAC,OAAO,GAAGC,MAAM,CAACD,OAAP,GAAiBtC,IAA3B"},"metadata":{},"sourceType":"script"}